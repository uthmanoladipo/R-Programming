# Load necessary library
library(dplyr)

# Correlation coefficients data
cor_matrix <- data.frame(
  BREED = c(1.00000000, 0.0000000, -0.02207177, 0.399871476, -0.39038592, 0.16646904, 0.20243321, 0.34132951, -0.67798133, -0.52225949, 0.26605694, -0.16689905, 0.32513606),
  TREATMENT = c(0.00000000, 1.0000000, -0.65778558, -0.682495562, 0.61027520, -0.80744500, -0.81899223, -0.79261032, -0.42509447, -0.439851037, -0.15140592, -0.18137678, -0.505135137),
  TCOL = c(-0.02207177, -0.6577856, 1.00000000, 0.523953490, -0.19596310, 0.84613734, 0.83861985, 0.58090032, 0.25291597, 0.244571935, 0.02798262, 0.16880859, 0.426581726),
  TRIG = c(0.39987148, -0.6824956, 0.52395349, 1.000000000, -0.60686802, 0.65803021, 0.72012543, 0.74140683, -0.08705321, 0.000456351, 0.17723911, 0.076905236, 0.401465430),
  HDL = c(-0.39038592, 0.6102752, -0.19596310, -0.606868022, 1.00000000, -0.68194654, -0.69837026, -0.90380158, 0.02691234, -0.042378790, -0.12104863, -0.08246550, -0.418116683),
  LDL = c(0.16646904, -0.8074450, 0.84613734, 0.658030208, -0.68194654, 1.00000000, 0.99623635, 0.91248620, 0.19841916, 0.221452181, 0.07253998, 0.17406033, 0.540005724),
  NHDL = c(0.20243321, -0.8189922, 0.83861985, 0.720125431, -0.69837026, 0.99623635, 1.00000000, 0.92571598, 0.16900537, 0.201195047, 0.08718591, 0.16984002, 0.543740701),
  TCHDL = c(0.34132951, -0.7926103, 0.58090032, 0.741406825, -0.90380158, 0.91248620, 0.92571598, 1.00000000, 0.05749013, 0.125168935, 0.13881544, 0.12913447, 0.533917955),
  TNI = c(-0.67798133, -0.4250945, 0.25291597, -0.087053206, 0.02691234, 0.19841916, 0.16900537, 0.05749013, 1.00000000, 0.922738882, -0.17313440, 0.05489641, -0.064523698),
  TNT = c(-0.52225949, -0.4398510, 0.24457193, 0.000456351, -0.04237879, 0.22145218, 0.20119505, 0.12516893, 0.92273888, 1.000000000, -0.17128517, -0.06409153, -0.005093408),
  LV = c(0.26605694, -0.1514059, 0.02798262, 0.177239112, -0.12104863, 0.07253998, 0.08718591, 0.13881544, -0.17313440, -0.171285174, 1.00000000, 0.04755069, 0.178737559),
  IVS = c(-0.16689905, -0.1813768, 0.16880859, 0.076905236, -0.08246550, 0.17406033, 0.16984002, 0.12913447, 0.05489641, -0.064091528, 0.04755069, 1.00000000, 0.059841416),
  RV = c(0.32513606, -0.5051351, 0.42658173, 0.401465430, -0.41811668, 0.54000572, 0.54374070, 0.53391795, -0.06452370, -0.005093408, 0.17873756, 0.05984142, 1.000000000)
)
cor_matrix <- round(cor_matrix, 2)

# Significance indicators data
significance_matrix <- data.frame(
  BREED = c("*", "", "", "*", "*", "", "", "*", "*", "*", "*", "", "*"),
  TREATMENT = c("", "*", "*", "*", "*", "*", "*", "*", "*", "*", "", "", "*"),
  TCOL = c("", "*", "*", "*", "", "*", "*", "*", "", "", "", "", "*"),
  TRIG = c("*", "*", "*", "*", "*", "*", "*", "*", "", "", "", "", "*"),
  HDL = c("*", "*", "", "*", "*", "*", "*", "*", "", "", "", "", "*"),
  LDL = c("", "*", "*", "*", "*", "*", "*", "*", "", "", "", "", "*"),
  NHDL = c("", "*", "*", "*", "*", "*", "*", "*", "", "", "", "", "*"),
  TCHDL = c("*", "*", "*", "*", "*", "*", "*", "*", "", "", "", "", "*"),
  TNI = c("*", "*", "", "", "", "", "", "", "*", "*", "", "", ""),
  TNT = c("*", "*", "", "", "", "", "", "", "*", "*", "", "", ""),
  LV = c("*", "", "", "", "", "", "", "", "*", "*", "*", "", ""),
  IVS = c("", "", "", "", "", "", "", "", "", "", "", "*", ""),
  RV = c("*", "*", "*", "*", "*", "*", "*", "*", "", "", "", "", "*")
)

# Combine both data frames
combined_matrix <- cor_matrix
combined_matrix[] <- Map(function(x, y) ifelse(y != "", paste0(x, y), x), cor_matrix, significance_matrix)

# Print the combined matrix
print(combined_matrix)

# Step 3: Convert the matrix to a data frame
cor_df <- as.data.frame(combined_matrix)

# Step 4: Save the data frame to a CSV file
write.csv(cor_df, file = "correlation_matrix.csv", row.names = TRUE)

# Step 5: Save the data frame to an Excel file
install.packages("writexl")
library(writexl)
write_xlsx(cor_df, path = "correlation_matrix.xlsx")
